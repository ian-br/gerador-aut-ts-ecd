<!DOCTYPE html>
<html>
	<meta charset="utf-128">
	<head>
		<title> Gerador Automático - Termo de Substituição da ECD </title>
	</head>
	<body>
	
		<div id="divTexto">
			<p style="line-height: 18px; font-size: 20px;  font-family: carlito;">
				<script>
					// Exibir introdução ao sistema
					alert("Gerador Automático - Termo de Substituição da ECD (Versão BETA) | Clique em OK para continuar.");
					alert("Insira os dados solicitados a seguir para preenchimento do documento.");
					// Ler dados necessários para preencher o documento 
					var nomeEmpresa = prompt("Razão social da empresa:");
					var cnpjEmpresa = prompt("CNPJ da empresa:");
					var hashRecibo = prompt("Hash do recibo da ECD (apenas letras e números):");
					var dataEnvio = prompt("Data de envio da ECD: (xx/xx/xxxx)");
					var horarioEnvio = prompt("Horário de envio da ECD (xx:xx:xx):");
					var municipioEmpresa = prompt("Município de cadastro da empresa:");
					var dataAtual = prompt("Data atual (xx de xxxxx de xxxx):");
					var nomeContador = prompt("Nome completo do contador responsável:");
					var cpfContador = prompt("CPF do contador responsável:");
					var crcContador = prompt("Registro CRC do contador responsável:");
					// Construir texto
					var texto = ("Termo de Substituição da Escrituração Contábil Digital (ECD) <br> <br> Empresa: "+nomeEmpresa+" <br> CNPJ: "+cnpjEmpresa+" <br> Recibo: "+hashRecibo+" <br> Data: "+dataEnvio+" às "+horarioEnvio+" <br> Contador: "+nomeContador+" <br> CPF: "+cpfContador+" <br> CRC: "+crcContador+" <br> <br> Motivo da substituição: <br> Declaramos, para os devidos fins, que a substituição da Escrituração Contábil Digital (ECD) entregue originalmente sob o número de recibo "+hashRecibo+" se faz necessária em virtude de conter erros que não podem ser corrigidos por meio de lançamentos extemporâneos, nos termos das Normas Brasileiras  de Contabilidade (NBC’s). Após análise detalhada, identificou-se que os lançamentos foram incorretamente preenchidos, necessitando, portanto, de sua retificação para assegurar a exatidão e conformidade das informações contábeis da empresa "+nomeEmpresa+". <br> <br> "+municipioEmpresa+", "+dataAtual+" <br> <br> <br> Assinatura do responsável pela escrituração: <br> <br> <br> <br> <br> <br> ________________________________ <br> <br> "+nomeContador+" <br> CPF: "+cpfContador+" <br> CRC: "+crcContador+" ");
					// Exibir texto
					document.write(texto);
					// Exibir pop-up de créditos ao desenvolvedor
					alert("Desenvolvido por Ian Amaral B. Moreira | ian.abm@hotmail.com | linkedin.com/in/ian-abm/");
				</script>			
			</p>
		</div>
		
		<button onclick="salvarDiv()"> Salvar arquivo em PDF </button>
		
		<script>
			// Garantir que apenas o texto do documento seja salvo
			function salvarDiv() {
				// Salvar os estilos originais
				var estiloOriginal = document.body.innerHTML;
				// Selecionar o conteúdo da divTexto
				var textoDocumento = document.getElementById('divTexto').innerHTML;
				// Alterar o conteúdo do body apenas para a divTexto
				document.body.innerHTML = textoDocumento;
				// Imprimir
				window.print();
				// Restaurar o conteúdo original do body
				document.body.innerHTML = estiloOriginal;
				// Recarregar a página para garantir que os eventos JavaScript sejam restaurados
				location.reload();
			}
		</script>
		
	</body>
</html>